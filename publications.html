<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Publications — Laura Díaz Sáez Research Group</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >

  <!-- Site overrides -->
  <link rel="stylesheet" href="assets/site.css">
  <meta name="description" content="Publications — Antimicrobial Drug Discovery (IQF-CSIC, Madrid, Spain).">

  <style>
    /* Subtle section styling for year headers and list spacing */
    #pub-list h3 {
      margin-top: 2rem;
      margin-bottom: .75rem;
      border-left: 4px solid #6c757d;
      padding-left: 10px;
      color: #e0e0e0;
    }
    #pub-list ul {
      padding-left: 1rem; /* neat bullet alignment */
      margin-bottom: 0;
    }
    #pub-list li {
      margin-bottom: .85rem;
      line-height: 1.5;
    }
    .pub-meta { font-style: italic; }
    .pub-actions a { text-decoration: underline; }
  </style>
</head>

<body class="d-flex h-100 text-center">
  <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">

    <!-- Top navigation -->
    <header class="mb-auto text-center">
      <div>
        <h3 class="mb-3">Antimicrobial Drug Discovery Lab</h3>
        <nav class="nav nav-masthead justify-content-center">
          <a class="nav-link fw-semibold" href="index.html">Home</a>
          <a class="nav-link fw-semibold" href="research.html">Research</a>
          <a class="nav-link fw-semibold" href="collaborations.html">Collaborations</a>
          <a class="nav-link fw-semibold" href="people.html">People</a>
          <a class="nav-link fw-semibold active" aria-current="page" href="publications.html">Publications</a>
          <a class="nav-link fw-semibold" href="join.html">Join us</a>
        </nav>
      </div>
    </header>

    <!-- Main content -->
    <main class="px-3 my-auto text-start">
      <div class="container my-5" style="max-width: 900px;">
        <h1 class="display-4 text-center mb-2">Publications</h1>
        <p class="lead text-center text-white-50 mb-4">Recent scientific contributions from our group.</p>

        <!-- Year index (auto-filled) -->
        <div id="year-index" class="d-flex flex-wrap gap-2 justify-content-center mb-4"></div>

        <div id="pub-list">
          <p class="text-center text-white-50">Loading…</p>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="mt-auto text-white-50">
      <p class="mb-1">Cover template for <a href="https://getbootstrap.com" target="_blank" rel="noopener">Bootstrap</a>.</p>
      <p class="mb-0">© <span id="year"></span> Laura Díaz Sáez Research Group</p>
    </footer>
  </div>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"
  ></script>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    (async function loadPublications() {
      const listEl = document.getElementById('pub-list');
      const indexEl = document.getElementById('year-index');

      try {
        const res = await fetch('assets/publications.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('Failed to load publications.json');
        const pubs = await res.json();

        if (!Array.isArray(pubs) || pubs.length === 0) {
          listEl.innerHTML = `<div class="alert alert-warning">No publications to display yet.</div>`;
          indexEl.innerHTML = '';
          return;
        }

        // Group by year
        const byYear = pubs.reduce((acc, p) => {
          const y = (p.year && String(p.year).trim()) || 'In press';
          (acc[y] ||= []).push(p);
          return acc;
        }, {});

        // Sort years: "In press" first, then numeric years desc, then anything else
        const years = Object.keys(byYear).sort((a, b) => {
          const isAInPress = a.toLowerCase() === 'in press';
          const isBInPress = b.toLowerCase() === 'in press';
          if (isAInPress && !isBInPress) return -1;
          if (!isAInPress && isBInPress) return 1;
          const ai = parseInt(a) || -Infinity;
          const bi = parseInt(b) || -Infinity;
          return bi - ai;
        });

        // Year index pills
        indexEl.innerHTML = years.map(y =>
          `<a class="btn btn-sm btn-outline-light" href="#year-${CSS.escape(y)}">${y}</a>`
        ).join('');

        // Render lists
        listEl.innerHTML = years.map(year => {
          const items = byYear[year].map(p => {
            const title = p.title || 'Untitled';
            const authors = p.authors ? `<span class="text-white-50">${p.authors}</span>` : '';
            const venue = p.venue ? `<span class="pub-meta">${p.venue}</span>` : '';
            const yearTxt = p.year ? ` (${p.year})` : '';
            const link = p.url || p.eprint_url;
            const linkHtml = link ? `<span class="pub-actions ms-1"><a href="${link}" target="_blank" rel="noopener">View</a></span>` : '';
            const cites = (p.cited_by && Number(p.cited_by) > 0)
              ? `<span class="ms-2 text-white-50">Cited by ${p.cited_by}</span>` : '';

            return `
              <li>
                <strong>${title}</strong><br>
                ${authors ? `${authors}<br>` : ''}
                ${venue}${yearTxt} ${linkHtml} ${cites}
              </li>
            `;
          }).join('');

          return `
            <h3 id="year-${year}">${year}</h3>
            <ul>
              ${items}
            </ul>
          `;
        }).join('');
      } catch (e) {
        console.error(e);
        listEl.innerHTML = `<div class="alert alert-warning">Couldn’t load publications right now.</div>`;
        indexEl.innerHTML = '';
      }
    })();
  </script>
</body>
</html>
