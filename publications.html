<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Publications — Laura Díaz Sáez Research Group</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >

  <!-- Site overrides -->
  <link rel="stylesheet" href="assets/site.css?v=1100">
  <meta name="description" content="Publications — Antimicrobial Drug Discovery (IQF-CSIC, Madrid, Spain).">
</head>

<body class="d-flex h-100 text-center inner-page">
  <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">

    <!-- Top navigation -->
    <header class="mb-auto text-center">
      <div>
        <h3 class="mb-3">Antimicrobial Drug Discovery Lab</h3>
        <nav class="nav nav-masthead justify-content-center">
          <a class="nav-link fw-semibold" href="index.html">Home</a>
          <a class="nav-link fw-semibold" href="research.html">Research</a>
          <a class="nav-link fw-semibold" href="collaborations.html">Collaborations</a>
          <a class="nav-link fw-semibold" href="people.html">People</a>
          <a class="nav-link fw-semibold active" aria-current="page" href="publications.html">Publications</a>
          <a class="nav-link fw-semibold" href="join.html">Join us</a>
        </nav>
      </div>
    </header>

    <!-- Main content (same cover layout) -->
    <main class="px-3 my-auto">
      <!-- Main Title to match other pages -->
      <h1 class="display-4 text-center mb-5">Publications</h1>

      <!-- Section 1: Recent -->
      <section class="mb-5">
        <h3 class="text-center mb-2">Recent scientific contributions from our group</h3>
        <p class="lead text-center text-white-50 mb-4">Publications from 2025 onward (including “In press”).</p>

        <!-- Year index -->
        <div id="recent-index" class="d-flex flex-wrap justify-content-center gap-2 mb-3"></div>

        <!-- List -->
        <div id="recent-list" class="pub-list">
          <p class="text-center text-white-50">Loading…</p>
        </div>
      </section>

      <hr class="my-5">

      <!-- Section 2: Older -->
      <section>
        <h3 class="text-center mb-2">Other scientific contributions by Laura Díaz Sáez</h3>
        <p class="lead text-center text-white-50 mb-4">Publications prior to 2025.</p>

        <!-- Year index -->
        <div id="other-index" class="d-flex flex-wrap justify-content-center gap-2 mb-3"></div>

        <!-- List -->
        <div id="other-list" class="pub-list">
          <p class="text-center text-white-50">Loading…</p>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="mt-auto text-white-50">
      <p class="mb-1">Cover template for <a href="https://getbootstrap.com" target="_blank" rel="noopener">Bootstrap</a>.</p>
      <p class="mb-0"> <span id="year"></span> Laura Díaz Sáez Research Group</p>
    </footer>
  </div>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"
  ></script>

  <script>
  document.getElementById('year').textContent = new Date().getFullYear();

  (async function () {
    const RECENT_YEAR = 2025;

    const elRecentList  = document.getElementById('recent-list');
    const elRecentIndex = document.getElementById('recent-index');
    const elOtherList   = document.getElementById('other-list');
    const elOtherIndex  = document.getElementById('other-index');

    function showError(targetList, targetIndex, msg) {
      targetList.innerHTML = `<div class="alert alert-warning">${msg}</div>`;
      targetIndex.innerHTML = '';
    }

    function toYear(v) {
      if (!v) return NaN;
      const n = parseInt(v, 10);
      return Number.isFinite(n) ? n : NaN;
    }

    function isInPress(p) {
      if (!p.year) return false;
      const y = String(p.year).toLowerCase();
      return y.includes('press') || y.includes('ahead');
    }

    // Make a safe fragment/id: "In press" -> "in-press", "2025" -> "2025"
    function slug(v) {
      return String(v)
        .toLowerCase()
        .trim()
        .replace(/[^\w]+/g, '-')   // non-word -> dashes
        .replace(/-+/g, '-')       // collapse dashes
        .replace(/^-|-$/g, '');    // trim dashes
    }

    function renderSection(listEl, indexEl, groups) {
      const years = Object.keys(groups).sort((a, b) => {
        const ai = parseInt(a) || -Infinity;
        const bi = parseInt(b) || -Infinity;
        return bi - ai;
      });

      // Year pills (use the SAME slug for href and id)
      indexEl.innerHTML = years.map(y => {
        const yid = `y-${slug(y)}`;
        return `<a class="btn btn-sm btn-outline-light" href="#${yid}">${y}</a>`;
      }).join('');

      // Year blocks
      listEl.innerHTML = years.map(year => {
        const yid = `y-${slug(year)}`;
        const items = groups[year].map(p => {
          const title = p.title || 'Untitled';
          const authors = p.authors ? `<span class="text-white-50">${p.authors}</span>` : '';
          const venue = p.venue ? `<span class="pub-meta">${p.venue}</span>` : '';
          const yearTxt = p.year ? ` (${p.year})` : '';
          const link = p.url || p.eprint_url;
          const linkHtml = link ? `<span class="pub-actions ms-1"><a href="${link}" target="_blank" rel="noopener">View</a></span>` : '';
          const cites = (p.cited_by && Number(p.cited_by) > 0)
            ? `<span class="ms-2 text-white-50">Cited by ${p.cited_by}</span>` : '';
          return `
            <li class="mb-3">
              <strong>${title}</strong><br>
              ${authors ? `${authors}<br>` : ''}
              ${venue}${yearTxt} ${linkHtml} ${cites}
            </li>
          `;
        }).join('');

        return `
          <h4 id="${yid}" class="year-title">${year}</h4>
          <ul class="mt-2">${items}</ul>
        `;
      }).join('');
    }

    try {
      const res = await fetch('assets/publications.json', { cache: 'no-store' });
      if (!res.ok) {
        showError(elRecentList, elRecentIndex, `Failed to load publications.json (HTTP ${res.status}).`);
        showError(elOtherList, elOtherIndex, '');
        return;
      }

      const pubs = await res.json();
      if (!Array.isArray(pubs)) {
        showError(elRecentList, elRecentIndex, 'Publications file is not a JSON array.');
        showError(elOtherList, elOtherIndex, '');
        return;
      }
      if (pubs.length === 0) {
        showError(elRecentList, elRecentIndex, 'No publications to display yet.');
        showError(elOtherList, elOtherIndex, '');
        return;
      }

      const recent = [];
      const older  = [];
      for (const p of pubs) {
        const y = toYear(p.year);
        if (isInPress(p) || (Number.isFinite(y) && y >= RECENT_YEAR)) {
          recent.push(p);
        } else {
          older.push(p);
        }
      }

      const groupByYear = arr => arr.reduce((acc, p) => {
        const key = (p.year && String(p.year).trim()) || 'In press';
        (acc[key] ||= []).push(p);
        return acc;
      }, {});

      const recentGroups = groupByYear(recent);
      const olderGroups  = groupByYear(older);

      if (recent.length) renderSection(elRecentList, elRecentIndex, recentGroups);
      else showError(elRecentList, elRecentIndex, 'No recent publications yet.');

      if (older.length) renderSection(elOtherList, elOtherIndex, olderGroups);
      else showError(elOtherList, elOtherIndex, 'No earlier publications found.');

      // Optional: if page loads with a hash, scroll to it smoothly
      if (location.hash && location.hash.startsWith('#y-')) {
        const t = document.querySelector(location.hash);
        if (t) t.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    } catch (e) {
      console.error(e);
      showError(elRecentList, elRecentIndex, "Couldn't load publications right now.");
      showError(elOtherList, elOtherIndex, '');
    }
  })();
</script>


  <!-- Smooth scroll and center the year when clicking a date -->
  <script>
    function scrollToCenter(target) {
      const rect = target.getBoundingClientRect();
      const absoluteTop = window.scrollY + rect.top;
      const y = Math.max(absoluteTop - (window.innerHeight - rect.height) / 2, 0);
      window.scrollTo({ top: y, behavior: 'smooth' });
    }

    document.addEventListener('click', (e) => {
      const a = e.target.closest('a[href^="#y-"]');
      if (!a) return;
      const id = a.getAttribute('href').slice(1);
      const target = document.getElementById(id);
      if (!target) return;

      e.preventDefault();
      history.replaceState(null, '', '#' + id);
      scrollToCenter(target);
    });

    window.addEventListener('load', () => {
      const id = (location.hash || '').slice(1);
      if (id && id.startsWith('y-')) {
        const target = document.getElementById(id);
        if (target) setTimeout(() => scrollToCenter(target), 100);
      }
    });
  </script>
</body>
</html>
